# 数据分析平台使用说明

## 技术架构
- 前端：纯原生 JavaScript + CSS3 + HTML5
- 数据处理：xlsx.js 库
- 存储：浏览器 localStorage + Supabase 数据库

## 基本使用说明

### 网站功能
1. 数据导入
   - 支持上传 Excel 文件（.xlsx, .xls 格式）
   - 可以通过拖拽或点击选择文件按钮上传
   - 上传成功后自动启用"开始分析排名"按钮

2. 分析参数设置
   - 平均在线人数：填写直播间实际平均在线人数
   - 整场单品成交比例要求：设置期望的成交比例（默认10%）
   - 讲解期望成交比例：设置单次讲解的期望成交比例（默认5%）
   - 系统会自动计算期望每次讲解的成交单量

3. 权重编辑
   - 提供四种预设权重方案
   - 支持实时编辑和保存权重设置
   - 权重总和必须为100%

4. 数据展示
   - 支持显示前10名、前20名或前30名商品
   - 显示每个商品的详细得分和总分
   - 提供原始数据预览功能
   - 支持选择和高亮标记商品
   - 支持一键清空所有选择

## 重要配置文件说明

### 1. 密码配置
- 文件位置：项目根目录下的 `password.txt`
- 修改方法：
  1. 直接编辑 `password.txt` 文件
  2. 输入新密码（不要包含空格或换行符）
  3. 保存文件
- 登录有效期：48小时

### 2. 权重配置
- 文件位置：项目根目录下的 `weightPresets.js`
- 预设方案：
  1. 曝光成交率优先
     ```javascript
     exposureConversion: {
         name: "曝光成交率优先",
         weights: {
             efficiency: 15,    // 讲解效率分权重
             exposure: 35,      // 曝光点击分权重
             conversion: 35,    // 点击成交分权重
             transaction: 15    // 成交件数分权重
         }
     }
     ```
  2. 成交件数优先（效率15%，曝光15%，转化20%，成交50%）
  3. 讲解效率优先（效率50%，曝光20%，转化15%，成交15%）
  4. 自定义方案（可在界面上直接修改）

## 得分计算逻辑

### 1. 讲解效率分
```
效率得分 = min(max(0, (成交件数/讲解次数)/(在线人数×讲解期望成交比例)×100), 100)
```
- 讲解期望成交比例默认为5%
- 分数范围：0-100分

### 2. 曝光点击分
```
点击得分 = min(点击率×5, 100)
```
- 点击率 = 点击人数/曝光人数
- 分数范围：0-100分

### 3. 点击成交分
```
成交得分 = min(成交率×10, 100)
```
- 成交率 = 成交件数/点击人数
- 分数范围：0-100分

### 4. 成交件数分
```
成交分 = min((成交件数/在线人数×100)/成交比例要求×100, 100)
```
- 成交比例要求默认为10%
- 分数范围：0-100分

### 5. 总分计算
```
总分 = 效率得分×效率权重 + 点击得分×点击权重 + 成交得分×成交权重 + 成交分×成交权重
```
- 所有权重之和必须为100%
- 最终得分范围：0-100分

## 文件结构
```
├── index.html          // 主页面
├── live-display.html   // 直播展示页面
├── styles.css          // 样式文件
├── script.js           // 主要逻辑
├── config.js           // 配置文件
├── weightPresets.js    // 权重预设配置
├── password.txt        // 密码文件
└── docs/
    └── README.md      // 使用说明
```

## 注意事项
1. 权重设置
   - 所有权重之和必须为100%
   - 权重修改后立即生效
   - 支持实时保存
   - 界面修改的权重保存在浏览器本地，清除浏览器数据会恢复默认值

2. 数据处理
   - 自动过滤无效数据
   - 自动处理异常值
   - 支持大数据量处理

3. 浏览器兼容
   - 支持主流现代浏览器
   - 需要启用 JavaScript
   - 需要支持 localStorage 